extends base

block extrahead
  link(rel='stylesheet', href='/css/game.css')
  script(src='/js/game.js')
  script(src='/js/chat_module.js')

block content
  #game_resources(hidden='hidden')
    for image in images
      img(id= image, src='/images/game/#{image}.png')
  canvas#game_canvas(width='700px', height='500px')
  h1 Chat Box
  div(ng-app='gameChat', ng-controller='chatController')
    #chatbox(style='width:500px;height:300px;overflow-y:auto')
      div(ng-repeat='one_chat in full_chat')
        p {{one_chat.name}}: {{one_chat.thought}}
    form
      input(type='text',ng-model='createForm.thought')
      button(ng-click='createChat()', type='submit') Post
    script.
      previous_scroll_height = 300;
      function scrollnow(){
        if($('#chatbox').prop('scrollHeight')>previous_scroll_height){
          $('#chatbox').scrollTop($('#chatbox').prop('scrollHeight'));
          previous_scroll_height = $('#chatbox').prop('scrollHeight');
        }
        window.requestAnimationFrame(scrollnow);
      }
      scrollnow();
