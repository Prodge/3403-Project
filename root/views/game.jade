extends base

block extrahead
    link(rel='stylesheet', href='/css/game.css')
    script(src='/js/game.js')
    script(src='/js/comment_section_module.js')

block content
    #game_resources(hidden='hidden')
      for image in images
        img(id= image)(src='/images/game/#{image}.png')
    canvas#game_canvas(width='700px', height='500px')
    h1 Comments
    br
    div(ng-app='actionComment', ng-controller='commentController')
      p #{user.name}
      p There are total of {{all_comments.length}} commentsi
      br
      #chatbox(style='width:500px;height:300px;overflow-y:auto')
        div(ng-repeat='a_comment in all_comments')
          p {{a_comment.name}}: {{a_comment.thought}}
      br
      br
      br
      br
      form
        input(type='text',ng-model='formData.thought')
        button(ng-click='createComment()', type='submit') Post
      script.
        pheight = 300;
        function scrollnow(){
          if($('#chatbox').prop('scrollHeight')>pheight){
            $('#chatbox').scrollTop($('#chatbox').prop('scrollHeight'));
            pheight = $('#chatbox').prop('scrollHeight');
          }
          window.requestAnimationFrame(scrollnow);
        }
        scrollnow();
